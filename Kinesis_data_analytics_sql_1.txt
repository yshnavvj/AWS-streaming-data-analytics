CREATE OR REPLACE STREAM "DESTINATION_SQL_STREAM" (order_count INTEGER);

CREATE OR REPLACE  PUMP "STREAM_PUMP" AS INSERT INTO "DESTINATION_SQL_STREAM" 
SELECT STREAM order_count from
(select STREAM COUNT(*) over TEN_SECOND_SLIDING_WINDOW as order_count
FROM "SOURCE_SQL_STREAM_001"
WINDOW TEN_SECOND_SLIDING_WINDOW as (RANGE INTERVAL '10' SECOND PRECEDING)
)
where order_count > 10;

CREATE OR REPLACE STREAM TRIGGER_COUNT_STREAM(
order_cnt INTEGER,
trigger_cnt INTEGER);

CREATE OR REPLACE  PUMP "trigger_count_pump" AS INSERT INTO TRIGGER_COUNT_STREAM
SELECT STREAM order_cnt,trigger_cnt from
(select STREAM order_count,COUNT(*) over window1 as trigger_cnt 
FROM "DESTINATION_SQL_STREAM" 
WINDOW window1 as (RANGE INTERVAL '60' SECOND PRECEDING)
)
where trigger_cnt >= 1;



